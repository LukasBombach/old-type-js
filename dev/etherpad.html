<!DOCTYPE html>
<html>
<head>
  <title>type demo</title>
  <link rel="stylesheet" href="./assets/normalize.css" />
  <link rel="stylesheet" href="./assets/main.css" />
</head>
<body>

<!--<h1>type demo</h1>-->
<!--<p id="test">Etiam porta sem malesuada magna mollis euismod. Cras mattis consectetur purus sit amet fermentum.<br/>Praesent commodo cursus magna, vel scelerisque nisl consectetur et.</p>-->
<!--tk-freight-text-pro-->
<div id="document" class="page"></div>


<script src="../src/plugins/Etherpad/vendor/socket.io.js"></script>
<script src="./assets/mousetrap.min.js"></script>
<script src="./../dist/type.js"></script>

<script>

  var Type = Type.fromEtherpad({
    root : document.getElementById('document')
  });


  /*
   *
   * Etherpad
   *
   */
  //var e = new Etherpad({apikey: '6535d0f30f0ce73a5a183dd1ee1909b5a233ed5d024bc0bc09bf35ee78ca0671'});
  /*var type = new Type();
  var epinput = type.etherpad({
    renderTo: document.getElementById('etherpad'),
    onload : function (input) {
      var ps = document.getElementById('etherpad');
      var t = ps.childNodes[0].childNodes[0];
      var c = new Caret();
      c._blink();
      c.moveTo(t, 0);

      document.addEventListener('keydown', function(e) {
        if(e.keyCode == 37) {
          c.moveLeft();
          input.progagateCaret(c.offset, 0);
          e.preventDefault();
        }
        else if(e.keyCode == 39) {
          c.moveRight();
          input.progagateCaret(c.offset, 0);
          e.preventDefault();
        }
        else if(e.keyCode == 38) {
          c.moveUp();
          input.progagateCaret(c.offset, 0);
          e.preventDefault();
        }
        else if(e.keyCode == 40) { // TODO keyCode is deprecated
          c.moveDown();
          input.progagateCaret(c.offset, 0);
          e.preventDefault();
        }
        else if(e.keyCode == 8) { // TODO keyCode is deprecated
          e.preventDefault();
          input.propagateUpdate(t.length, '-', c.offset - 1, 1);
          c.removeCharacter();
        }
        else if(e.keyCode == 32) { // space
          e.preventDefault();
          var val = ' ';
          input.propagateUpdate(t.length, '+', c.offset, val.length, val);
          c.insertText(val);
        }
      });

      document.addEventListener('keypress', function(event) {
        var key = event.keyCode || event.which;

        if(key === 8) {
          // backspace handling done at keydown
        } else {
          var val = String.fromCharCode(key);
          input.propagateUpdate(t.length, '+', c.offset, val.length, val);
          c.insertText(val);
        }
      });

      ps.childNodes[0].addEventListener("click", function(e) {
        var range;
        var textNode;
        var offset;
        range = document.caretRangeFromPoint(e.clientX, e.clientY);
        textNode = range.startContainer;
        offset = range.startOffset;
        if (textNode.nodeType == 3) {
          c.moveTo(textNode, offset);
          input.progagateCaret(offset, 0);
        }
      }, false);
    }
  });*/


</script>
</body>
</html>
